## **Database Architecture Document**

This document explains the architectural decisions made regarding data storage.

The application architecture involves two main services, each using different databases for distinct data storage needs:

- **User Service**: Stores user-related data in **PostgreSQL**.
- **Event Service**: Stores event-related and comment-related data in **MongoDB**.

#### **1. User Service (PostgreSQL)**

##### **Data Stored in PostgreSQL**:
- **Users**: This includes user-specific details such as:
  - `id`: A unique identifier for each user (primary key).
  - `username`: A unique string representing the user's name.
  - `email`: The user's email address, also unique.
  - `password`: The hashed password of the user for authentication.
  - `created_at`: Timestamp for when the user was created.

##### **Database DDL:**:

```sql
CREATE TABLE users (
  id SERIAL PRIMARY KEY,
  username VARCHAR(50) UNIQUE NOT NULL,
  email VARCHAR(100) UNIQUE NOT NULL,
  password VARCHAR(255) NOT NULL,
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

##### **Why PostgreSQL?**

User data (such as usernames, emails, and passwords) is structured, meaning it fits well within a relational database model. This type of data has well-defined relationships, constraints, and requirements for indexing (e.g., ensuring unique emails).

---

#### **2. Event Service (MongoDB)**

##### **Data Stored in MongoDB**:
- **Events**: Event-related details such as:
  - `id`: A unique identifier for each event (generated by MongoDB).
  - `title`: The title of the event.
  - `description`: A brief description of the event.
  - `date`: The date when the event will take place.
  - `createdBy`: An embedded document containing the user ID and username of the event creator.
  - `participants`: An array of usernames representing the participants of the event.
  - `comments`: An array of comments, where each comment contains:
    - `userId`: The ID of the user who made the comment.
    - `username`: The username of the user who made the comment.
    - `text`: The comment text.
    - `createdAt`: The timestamp when the comment was made.

##### **Example:**:

```json
{
  "_id": "609c35b3f0a5e65e4cd5fb12",
  "title": "Node.js Workshop",
  "description": "A workshop to learn Node.js",
  "date": "2024-12-15T10:00:00Z",
  "createdBy": {
    "userId": "1",
    "username": "john_doe"
  },
  "participants": ["john_doe", "jane_doe"],
  "comments": [
    {
      "userId": "2",
      "username": "jane_doe",
      "text": "Looking forward to it!",
      "createdAt": "2024-12-01T10:00:00Z"
    }
  ],
  "createdAt": "2024-11-01T10:00:00Z",
  "updatedAt": "2024-12-01T10:00:00Z"
}
```

##### **Why MongoDB?**

Event data (such as titles, descriptions, dates, participants, and comments) is more dynamic in nature, which is ideal for **MongoDB**. Events have a more hierarchical structure (comments, participants, etc.), which is well-suited to MongoDB's ability to store complex nested documents. This flexibility makes MongoDB the better choice for storing event details, especially since the structure of an event can change over time.

---

### **Summary**

| Service         | Database   | Data Stored                                                                 |
|-----------------|------------|-----------------------------------------------------------------------------|
| **User Service**| PostgreSQL | Users: `id`, `username`, `email`, `password`, `created_at`                   |
| **Event Service**| MongoDB   | Events: `title`, `description`, `date`, `createdBy`, `participants`, `comments` |

---

